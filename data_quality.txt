# data_quality.py
import seaborn as sns
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

def data_quality(df):
  print('\nKоличество пропусков в каждом столбце:')
  print(df.isnull().sum())

  print('\nKорреляционная матрица:')
  corr_matrix = df.corr(numeric_only=True)
  plt.figure(figsize=(20, 16))
  sns.heatmap(corr_matrix, annot=True, cmap='bwr', fmt=".2f", square=True, linewidths=.5)
  plt.title('Тепловая карта корреляционной матрицы')
  plt.xticks(rotation=45)
  plt.yticks(rotation=0)
  plt.tight_layout()
  plt.show()
  # гистограмма распределения AQI
  plt.figure(figsize=(8, 6))
  sns.histplot(df['AQI'], kde=True, bins=40, color='blue')
  plt.title('Гистограмма распределения AQI')
  plt.xlabel('Индекс AQI')
  plt.ylabel('Количество')
  plt.tight_layout()
  plt.show()

  # ящик с усами общий
  plt.figure(figsize=(15, 8))
  sns.boxplot(data=df.select_dtypes(include=np.number), orient='h')
  plt.title('Яшик с усами для числовых признаков - Общий вид')
  plt.show()

  # ящики с усами для числовых колонок
  numeric_cols = df.select_dtypes(include=np.number).columns
  for col in numeric_cols:
    plt.figure(figsize=(4, 3))
    sns.boxplot(x=df[col], palette='pastel')
    plt.title(f'Ящик для {col}')
    plt.show()

  # гистограммы для категориальных данных
  obj_cols = df.select_dtypes(include=['object']).columns
  for col in obj_cols:
    plt.figure(figsize=(4, 3))
    sns.countplot(x=df[col], palette='pastel')
    plt.title(f'Гистограмма для {col}')
    plt.show()

  # гистограмма наблюдений по годам
  plt.figure(figsize=(10, 6))
  sns.countplot(x=df['Year'], palette='Set1')
  plt.title('Наблюдения по годам')
  plt.show()
  return